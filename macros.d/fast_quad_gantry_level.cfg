[gcode_macro QUAD_GANTRY_LEVEL]
rename_existing: BASE_QUAD_GANTRY_LEVEL
gcode:
  {% if not printer.quad_gantry_level.applied %}
    BASE_QUAD_GANTRY_LEVEL MAX_ADJUST=20 RETRIES=0 SAMPLES=1 SPEED=15  ; low-pass qgl
  {% endif %}
  BASE_QUAD_GANTRY_LEVEL HORIZONTAL_MOVE_Z=4 SPEED=5                   ; high-pass quick qgl
  G28 Z
